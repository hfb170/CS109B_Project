Includes both training and test codes
